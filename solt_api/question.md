# Ruby on Rails 認証API課題

## 要件

1. ユーザー登録APIエンドポイント (`/api/v1/register`) を作成してください。
   - ユーザー名、メールアドレス、パスワードを受け取ります。
   - パスワードは、ランダムに生成されたソルト値とSHA256を使用してハッシュ化してください。
   - ユーザー名とメールアドレスのユニーク性を確認してください。

2. ログインAPIエンドポイント (`/api/v1/login`) を作成してください。
   - メールアドレスとパスワードを受け取ります。
   - 正しい認証情報の場合、JWTトークンを生成して返してください。

3. パスワード変更APIエンドポイント (`/api/v1/change_password`) を作成してください。
   - 現在のパスワードと新しいパスワードを受け取ります。
   - JWTトークンによる認証を要求します。

4. ユーザープロフィールAPIエンドポイント (`/api/v1/profile`) を作成してください。
   - JWTトークンによる認証を要求します。
   - ユーザーの詳細情報を返します。

5. すべてのエンドポイントで適切なエラーハンドリングを実装してください。

6. パスワードの強度チェックを実装してください（最小8文字、大文字小文字を含む、数字を含む、特殊文字を含む）。

7. アカウントロックアウト機能を実装してください（5回連続でログイン失敗したら30分間ロックアウト）。

8. パスワードリセット機能を実装してください（`/api/v1/reset_password`）。
   - ユーザーのメールアドレスを受け取り、パスワードリセットトークンを生成して保存します。
   - リセットトークンとともに新しいパスワードを受け取り、パスワードを更新します。

9. API制限を実装してください（1分間に10リクエストまで）。

10. すべてのAPIリクエストとレスポンスをログに記録してください（パスワードなどの機密情報は除く）。

## 実装のヒント

- `bcrypt` gemを使用してパスワードのハッシュ化と検証を行うことができます。
- `jwt` gemを使用してJWTトークンの生成と検証を行うことができます。
- `rack-attack` gemを使用してAPI制限を実装できます。
- Active Modelのバリデーションを使用して、入力データの検証を行ってください。
- コントローラーでの処理はできるだけ薄くし、ビジネスロジックはモデルやサービスクラスに移動させてください。

実装後、各エンドポイントのテストを作成し、すべての要件が満たされていることを確認してください。

メモ：

```rb
# app/models/user.rb
require 'digest'

class User < ApplicationRecord
  before_save :hash_password

  # パスワードをハッシュ化して保存
  def hash_password
    self.password = Digest::SHA256.hexdigest(password) if password.present?
  end

  # パスワード認証
  def authenticate(input_password)
    hashed_input_password = Digest::SHA256.hexdigest(input_password)
    self.password == hashed_input_password
  end
end
```

基本方針は保存したものとの一致